<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clairvoyant of Yiwu</title>
    <link href="https://fonts.googleapis.com/css2?family=Baskervville:ital@0;1&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #122A6C 0%, #1a3a8f 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        h1, h2, h3 {
            font-family: 'Baskervville', serif;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #2d3748;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 15px;
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background: #e2e8f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #122A6C 0%, #1a3a8f 100%);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .controls {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .weight-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .weight-item {
            display: flex;
            flex-direction: column;
        }
        
        .weight-item label {
            font-size: 13px;
            color: #4a5568;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .weight-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #122A6C;
            cursor: pointer;
        }
        
        .weight-value {
            min-width: 50px;
            text-align: center;
            font-weight: 700;
            color: #122A6C;
        }
        
        .add-criteria-btn {
            padding: 10px 20px;
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
        }
        
        .add-criteria-btn:hover {
            background: #38a169;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: #f7fafc;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-content {
            padding: 20px;
        }
        
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }
        
        .product-category {
            font-size: 11px;
            color: #122A6C;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .bookmark-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .bookmark-btn:hover {
            transform: scale(1.2);
        }
        
        .product-name {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }
        
        .product-description {
            font-size: 13px;
            color: #718096;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
        }
        
        .price-item {
            text-align: center;
        }
        
        .price-label {
            font-size: 11px;
            color: #718096;
            margin-bottom: 4px;
        }
        
        .price-value {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
        }
        
        .price-value.buy {
            color: #48bb78;
        }
        
        .price-value.sell {
            color: #122A6C;
        }
        
        .scores {
            margin-bottom: 15px;
        }
        
        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .score-item:last-child {
            border-bottom: none;
        }
        
        .score-label {
            font-size: 12px;
            color: #4a5568;
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 150px;
        }
        
        .score-fill {
            flex: 1;
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .score-fill-inner {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #122A6C);
            transition: width 0.3s;
        }
        
        .score-number {
            font-weight: 700;
            font-size: 13px;
            min-width: 30px;
            text-align: right;
        }
        
        .total-score {
            background: linear-gradient(135deg, #122A6C 0%, #1a3a8f 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .total-score-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .total-score-value {
            font-size: 32px;
            font-weight: 700;
        }
        
        .view-links-btn {
            width: 100%;
            padding: 12px;
            background: #122A6C;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
        }
        
        .view-links-btn:hover {
            background: #0d1f4f;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #718096;
        }
        
        .links-section {
            margin-bottom: 25px;
        }
        
        .links-section h3 {
            font-size: 16px;
            color: #122A6C;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .link-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .link-item a {
            color: #122A6C;
            text-decoration: none;
            font-size: 14px;
            flex: 1;
        }
        
        .link-item a:hover {
            text-decoration: underline;
        }
        
        .link-price {
            font-weight: 700;
            color: #2d3748;
        }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: white;
            font-size: 18px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .custom-criteria {
            background: #fffaf0;
            border: 2px dashed #ed8936;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .custom-criteria input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .category-filter {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        
        .category-btn {
            padding: 12px 16px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s;
            color: #2d3748;
        }
        
        .category-btn:hover {
            border-color: #122A6C;
            background: #edf2f7;
        }
        
        .category-btn.active {
            background: linear-gradient(135deg, #122A6C 0%, #1a3a8f 100%);
            color: white;
            border-color: #122A6C;
        }
        
        .custom-category-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
        }
        
        .go-btn {
            padding: 12px 32px;
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .go-btn:hover {
            background: #38a169;
        }
        
        .populate-bar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .populate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .populate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.4);
        }
        
        .populate-btn.populated {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
        }
        
        .populate-btn.populated:hover {
            box-shadow: 0 5px 15px rgba(237, 137, 54, 0.4);
        }
        
        .sorting-controls {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .sort-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .sort-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .sort-btn.active {
            background: white;
            color: #122A6C;
            border-color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”® Clairvoyant of Yiwu</h1>
            <p class="subtitle">AI-powered product discovery for TikTok Shop success</p>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('research')">Product Research</button>
                <button class="tab" onclick="switchTab('bookmarks')">Bookmarked (<span id="bookmarkCount">0</span>)</button>
            </div>
        </div>
        
        <div id="researchTab" class="tab-content active">
            <div class="controls">
                <h3 style="margin-bottom: 15px; color: #2d3748;">Scoring Criteria Weights</h3>
                <div class="weight-controls" id="weightControls">
                    <!-- Weight sliders will be added here -->
                </div>
                <button class="add-criteria-btn" onclick="addCustomCriteria()">+ Add Custom Criteria</button>
                <div id="customCriteriaContainer"></div>
                
                <h3 style="margin: 30px 0 15px 0; color: #2d3748;">Filter by Category</h3>
                <div class="category-filter">
                    <button class="category-btn active" onclick="filterCategory('all')">All Products</button>
                    <button class="category-btn" onclick="filterCategory('Beauty & Skincare')">Beauty</button>
                    <button class="category-btn" onclick="filterCategory('Home & Kitchen')">Home</button>
                    <button class="category-btn" onclick="filterCategory('Tech & Gadgets')">Tech</button>
                </div>
                <div class="category-filter" style="margin-top: 10px;">
                    <button class="category-btn" onclick="filterCategory('Fitness & Wellness')">Fitness</button>
                    <button class="category-btn" onclick="filterCategory('Pet Supplies')">Pet</button>
                    <button class="category-btn" onclick="filterCategory('Fashion & Accessories')">Fashion</button>
                    <button class="category-btn" onclick="filterCategory('Stress Relief & Fidgets')">Stress Relief</button>
                </div>
                <div class="category-filter" style="margin-top: 10px;">
                    <button class="category-btn" onclick="filterCategory('Office Supplies')">Office</button>
                    <button class="category-btn" onclick="filterCategory('Baby & Kids')">Baby & Kids</button>
                    <button class="category-btn" onclick="filterCategory('Outdoor & Travel')">Outdoor</button>
                    <button class="category-btn" onclick="filterCategory('Automotive')">Automotive</button>
                </div>
                
                <div class="custom-category-section">
                    <h3 style="margin: 20px 0 10px 0; color: #2d3748;">Add Custom Category</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="customCategoryInput" placeholder="Enter category (e.g., Office Supplies, Baby Products)" style="flex: 1; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                        <button class="go-btn" onclick="addCustomCategory()">Go</button>
                    </div>
                </div>
            </div>
            
            <div id="populateBar" class="populate-bar" style="display: none;">
                <button id="populateBtn" class="populate-btn" onclick="populateProducts()">
                    Search for Products in This Category
                </button>
            </div>
            
            <div id="sortingControls" class="sorting-controls" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="color: white; margin: 0;">Sort By:</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="sort-btn active" onclick="sortProducts('score')">Score â†“</button>
                        <button class="sort-btn" onclick="sortProducts('price')">Sell Price â†“</button>
                        <button class="sort-btn" onclick="sortProducts('margin')">Margin â†“</button>
                    </div>
                </div>
            </div>
            
            <div id="productsContainer" class="products-grid">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>Researching trending products...</div>
                </div>
            </div>
        </div>
        
        <div id="bookmarksTab" class="tab-content">
            <div id="bookmarksContainer" class="products-grid">
                <div style="text-align: center; padding: 60px 20px; color: white; font-size: 18px;">
                    No bookmarked products yet. Start researching!
                </div>
            </div>
        </div>
    </div>
    
    <div id="linksModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalProductName"></div>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <div class="links-section">
                <h3>ðŸ›’ Where to Buy (Sourcing Links)</h3>
                <div id="buyLinks"></div>
            </div>
            
            <div class="links-section">
                <h3>ðŸ’° Where to Sell (Market Price Research)</h3>
                <div id="sellLinks"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Product database with real trending products from research
        const productDatabase = [
            {
                category: "Beauty & Skincare",
                name: "Vitamin C Glow Serum",
                description: "Korean beauty serum with 15% vitamin C, niacinamide, and hyaluronic acid. Perfect for dark spots and anti-aging.",
                imageUrl: "https://images.unsplash.com/photo-1620916566398-39f1143ab7be?w=400&h=300&fit=crop",
                buyPrice: 2.50,
                sellPrice: 17.00,
                scores: {
                    growth: 8.5,
                    youngAffluent: 9.0,
                    repeatPurchase: 8.0,
                    markup: 9.2,
                    competition: 6.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/category/vitamin-c-serum", vendor: "Guangzhou Beauty Co.", price: "$2.50" },
                    { url: "https://www.alibaba.com/product-detail/Vitamin-C-Serum", vendor: "Shenzhen Cosmetics Factory", price: "$2.80" },
                    { url: "https://www.made-in-china.com/vitamin-c-serum", vendor: "Zhejiang Skin Care Ltd", price: "$2.35" },
                    { url: "https://www.globalsources.com/vitamin-c-serum", vendor: "Hong Kong Beauty Supply", price: "$2.65" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/vitamin-c-serum", price: "$17.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/vitamin-c", price: "$16.50" },
                    { platform: "Shopify Stores", url: "https://shopify.com/search/vitamin-c", price: "$18.95" },
                    { platform: "Etsy", url: "https://etsy.com/vitamin-c-serum", price: "$19.99" }
                ]
            },
            {
                category: "Home & Kitchen",
                name: "Mini Portable Dishwasher",
                description: "Countertop dishwasher perfect for small apartments. 5L capacity, USB powered, quiet operation.",
                imageUrl: "https://images.unsplash.com/photo-1585659722983-3a675dabf23d?w=400&h=300&fit=crop",
                buyPrice: 15.00,
                sellPrice: 69.99,
                scores: {
                    growth: 9.0,
                    youngAffluent: 8.5,
                    repeatPurchase: 3.0,
                    markup: 8.8,
                    competition: 7.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/category/mini-dishwasher", vendor: "Ningbo Electronics", price: "$15.00" },
                    { url: "https://www.alibaba.com/mini-dishwasher", vendor: "Foshan Home Appliances", price: "$16.50" },
                    { url: "https://www.made-in-china.com/dishwasher", vendor: "Guangdong Kitchen Tech", price: "$14.80" },
                    { url: "https://www.globalsources.com/portable-dishwasher", vendor: "Shenzhen Smart Home", price: "$15.20" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/mini-dishwasher", price: "$69.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/dishwasher", price: "$64.50" },
                    { platform: "Walmart", url: "https://walmart.com/mini-dishwasher", price: "$72.00" },
                    { platform: "Target", url: "https://target.com/portable-dishwasher", price: "$75.99" }
                ]
            },
            {
                category: "Tech & Gadgets",
                name: "Magnetic Phone Mount",
                description: "360Â° rotating magnetic car mount with strong MagSafe compatibility. One-hand operation design.",
                imageUrl: "https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=400&h=300&fit=crop",
                buyPrice: 1.80,
                sellPrice: 19.99,
                scores: {
                    growth: 7.5,
                    youngAffluent: 8.0,
                    repeatPurchase: 6.0,
                    markup: 9.5,
                    competition: 5.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/magnetic-phone-mount", vendor: "Dongguan Tech Accessories", price: "$1.80" },
                    { url: "https://www.alibaba.com/phone-mount", vendor: "Shenzhen Mobile Parts", price: "$1.95" },
                    { url: "https://www.made-in-china.com/car-mount", vendor: "Guangzhou Auto Parts", price: "$1.75" },
                    { url: "https://www.globalsources.com/magnetic-mount", vendor: "Yiwu Trading Co.", price: "$1.85" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/magnetic-phone-mount", price: "$19.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/phone-mount", price: "$17.50" },
                    { platform: "eBay", url: "https://ebay.com/magnetic-mount", price: "$18.95" },
                    { platform: "Best Buy", url: "https://bestbuy.com/phone-mount", price: "$24.99" }
                ]
            },
            {
                category: "Fitness & Wellness",
                name: "Resistance Loop Bands Set",
                description: "5-piece fabric resistance bands with different resistance levels. Non-slip design, comes with carry bag.",
                imageUrl: "https://images.unsplash.com/photo-1598289431512-b97b0917affc?w=400&h=300&fit=crop",
                buyPrice: 3.50,
                sellPrice: 24.99,
                scores: {
                    growth: 8.0,
                    youngAffluent: 8.5,
                    repeatPurchase: 7.0,
                    markup: 9.0,
                    competition: 6.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/resistance-bands", vendor: "Yiwu Sports Equipment", price: "$3.50" },
                    { url: "https://www.alibaba.com/fitness-bands", vendor: "Nantong Fitness Factory", price: "$3.80" },
                    { url: "https://www.made-in-china.com/exercise-bands", vendor: "Zhejiang Sports Goods", price: "$3.40" },
                    { url: "https://www.globalsources.com/resistance-bands", vendor: "Xiamen Athletic Supply", price: "$3.65" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/resistance-bands", price: "$24.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/fitness-bands", price: "$22.50" },
                    { platform: "Dick's Sporting Goods", url: "https://dickssportinggoods.com/bands", price: "$26.99" },
                    { platform: "Walmart", url: "https://walmart.com/resistance-bands", price: "$23.88" }
                ]
            },
            {
                category: "Pet Supplies",
                name: "Self-Playing Cat Ball",
                description: "Interactive smart ball that moves automatically. USB rechargeable, keeps cats entertained for hours.",
                imageUrl: "https://images.unsplash.com/photo-1545249390-6bdfa286032f?w=400&h=300&fit=crop",
                buyPrice: 4.20,
                sellPrice: 28.99,
                scores: {
                    growth: 8.5,
                    youngAffluent: 7.5,
                    repeatPurchase: 5.5,
                    markup: 8.8,
                    competition: 6.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/cat-toy-ball", vendor: "Guangzhou Pet Products", price: "$4.20" },
                    { url: "https://www.alibaba.com/interactive-cat-ball", vendor: "Shenzhen Pet Tech", price: "$4.50" },
                    { url: "https://www.made-in-china.com/cat-toys", vendor: "Zhejiang Animal Toys", price: "$4.10" },
                    { url: "https://www.globalsources.com/pet-ball", vendor: "Ningbo Pet Supply", price: "$4.35" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/cat-interactive-ball", price: "$28.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/cat-ball", price: "$26.50" },
                    { platform: "Chewy", url: "https://chewy.com/cat-ball", price: "$29.99" },
                    { platform: "Petco", url: "https://petco.com/interactive-cat-toy", price: "$31.99" }
                ]
            },
            {
                category: "Beauty & Skincare",
                name: "Ice Roller & Gua Sha Set",
                description: "Face massage tool set for de-puffing and lymphatic drainage. Stainless steel roller stays cold longer.",
                imageUrl: "https://images.unsplash.com/photo-1596755389378-c31d21fd1273?w=400&h=300&fit=crop",
                buyPrice: 2.80,
                sellPrice: 18.99,
                scores: {
                    growth: 9.0,
                    youngAffluent: 9.5,
                    repeatPurchase: 4.0,
                    markup: 8.5,
                    competition: 7.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/ice-roller-gua-sha", vendor: "Guangzhou Beauty Tools", price: "$2.80" },
                    { url: "https://www.alibaba.com/facial-massage-tools", vendor: "Yiwu Cosmetic Accessories", price: "$3.00" },
                    { url: "https://www.made-in-china.com/gua-sha-set", vendor: "Shenzhen Skincare Tools", price: "$2.70" },
                    { url: "https://www.globalsources.com/ice-roller", vendor: "Ningbo Beauty Supply", price: "$2.90" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/ice-roller-gua-sha", price: "$18.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/face-roller", price: "$16.50" },
                    { platform: "Sephora", url: "https://sephora.com/gua-sha-set", price: "$22.00" },
                    { platform: "Ulta", url: "https://ulta.com/ice-roller", price: "$19.99" }
                ]
            },
            {
                category: "Home & Kitchen",
                name: "Silicone Air Fryer Liners",
                description: "Set of 2 reusable air fryer basket liners. Non-stick, dishwasher safe, fits 4-6qt air fryers.",
                imageUrl: "https://images.unsplash.com/photo-1585937421612-70e008356f35?w=400&h=300&fit=crop",
                buyPrice: 1.50,
                sellPrice: 12.99,
                scores: {
                    growth: 7.0,
                    youngAffluent: 6.5,
                    repeatPurchase: 8.5,
                    markup: 9.0,
                    competition: 5.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/silicone-air-fryer-liner", vendor: "Dongguan Silicone Products", price: "$1.50" },
                    { url: "https://www.alibaba.com/air-fryer-accessories", vendor: "Shenzhen Kitchen Supplies", price: "$1.65" },
                    { url: "https://www.made-in-china.com/air-fryer-liner", vendor: "Guangzhou Home Goods", price: "$1.45" },
                    { url: "https://www.globalsources.com/silicone-liner", vendor: "Ningbo Cookware", price: "$1.55" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/air-fryer-liner", price: "$12.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/air-fryer", price: "$11.50" },
                    { platform: "Walmart", url: "https://walmart.com/air-fryer-liner", price: "$13.88" },
                    { platform: "Target", url: "https://target.com/air-fryer-accessories", price: "$14.99" }
                ]
            },
            {
                category: "Fashion & Accessories",
                name: "Satin Scrunchie Set",
                description: "12-pack satin hair scrunchies in trending colors. Soft, prevents hair breakage, includes storage bag.",
                imageUrl: "https://images.unsplash.com/photo-1522337660859-02fbefca4702?w=400&h=300&fit=crop",
                buyPrice: 0.80,
                sellPrice: 9.99,
                scores: {
                    growth: 6.5,
                    youngAffluent: 7.5,
                    repeatPurchase: 9.0,
                    markup: 9.5,
                    competition: 4.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/satin-scrunchies", vendor: "Yiwu Hair Accessories", price: "$0.80" },
                    { url: "https://www.alibaba.com/hair-scrunchies", vendor: "Guangzhou Fashion Items", price: "$0.85" },
                    { url: "https://www.made-in-china.com/scrunchies-set", vendor: "Zhejiang Textile Factory", price: "$0.75" },
                    { url: "https://www.globalsources.com/satin-scrunchies", vendor: "Shenzhen Accessories", price: "$0.82" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/satin-scrunchies", price: "$9.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/scrunchies", price: "$8.50" },
                    { platform: "Etsy", url: "https://etsy.com/hair-scrunchies", price: "$11.99" },
                    { platform: "Urban Outfitters", url: "https://urbanoutfitters.com/scrunchies", price: "$12.00" }
                ]
            },
            {
                category: "Tech & Gadgets",
                name: "LED Sunset Projection Lamp",
                description: "360Â° rotation sunset lamp with 16 color modes. Perfect for photos/videos, USB powered, remote control.",
                imageUrl: "https://images.unsplash.com/photo-1513506003901-1e6a229e2d15?w=400&h=300&fit=crop",
                buyPrice: 5.50,
                sellPrice: 29.99,
                scores: {
                    growth: 8.0,
                    youngAffluent: 9.0,
                    repeatPurchase: 4.5,
                    markup: 8.2,
                    competition: 7.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/sunset-lamp", vendor: "Shenzhen LED Lights", price: "$5.50" },
                    { url: "https://www.alibaba.com/projection-lamp", vendor: "Guangzhou Lighting Co.", price: "$5.80" },
                    { url: "https://www.made-in-china.com/sunset-light", vendor: "Ningbo Electronics", price: "$5.40" },
                    { url: "https://www.globalsources.com/led-lamp", vendor: "Dongguan Tech Supply", price: "$5.65" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/sunset-lamp", price: "$29.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/sunset-light", price: "$27.50" },
                    { platform: "Urban Outfitters", url: "https://urbanoutfitters.com/sunset-lamp", price: "$35.00" },
                    { platform: "Walmart", url: "https://walmart.com/projection-lamp", price: "$31.88" }
                ]
            },
            {
                category: "Beauty & Skincare",
                name: "Under Eye Collagen Patches",
                description: "60 pairs of hydrogel under-eye patches with collagen and hyaluronic acid. Reduces dark circles and puffiness.",
                imageUrl: "https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?w=400&h=300&fit=crop",
                buyPrice: 3.20,
                sellPrice: 19.99,
                scores: {
                    growth: 8.5,
                    youngAffluent: 8.0,
                    repeatPurchase: 8.5,
                    markup: 8.7,
                    competition: 6.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/eye-patches", vendor: "Guangzhou Cosmetics Factory", price: "$3.20" },
                    { url: "https://www.alibaba.com/collagen-patches", vendor: "Shenzhen Beauty Products", price: "$3.40" },
                    { url: "https://www.made-in-china.com/eye-mask", vendor: "Zhejiang Skincare Ltd", price: "$3.10" },
                    { url: "https://www.globalsources.com/under-eye-patches", vendor: "Yiwu Beauty Supply", price: "$3.30" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/eye-patches", price: "$19.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/collagen-patches", price: "$17.99" },
                    { platform: "Sephora", url: "https://sephora.com/eye-patches", price: "$24.00" },
                    { platform: "Ulta", url: "https://ulta.com/under-eye-mask", price: "$21.99" }
                ]
            },
            {
                category: "Home & Kitchen",
                name: "Electric Milk Frother",
                description: "Handheld milk frother for coffee, matcha, protein shakes. 3-speed settings, USB rechargeable.",
                imageUrl: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop",
                buyPrice: 2.30,
                sellPrice: 14.99,
                scores: {
                    growth: 7.5,
                    youngAffluent: 8.5,
                    repeatPurchase: 6.0,
                    markup: 8.5,
                    competition: 6.5
                },
                buyLinks: [
                    { url: "https://www.1688.com/milk-frother", vendor: "Ningbo Kitchen Appliances", price: "$2.30" },
                    { url: "https://www.alibaba.com/electric-frother", vendor: "Guangzhou Coffee Tools", price: "$2.50" },
                    { url: "https://www.made-in-china.com/milk-frother", vendor: "Shenzhen Home Gadgets", price: "$2.25" },
                    { url: "https://www.globalsources.com/coffee-frother", vendor: "Dongguan Kitchen Supply", price: "$2.40" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/milk-frother", price: "$14.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/frother", price: "$12.99" },
                    { platform: "Williams Sonoma", url: "https://williams-sonoma.com/milk-frother", price: "$19.95" },
                    { platform: "Target", url: "https://target.com/electric-frother", price: "$16.99" }
                ]
            },
            {
                category: "Stress Relief & Fidgets",
                name: "Pop It Bubble Sensory Toy",
                description: "Silicone fidget toy with bubbles on both sides. Stress relief, anxiety reduction, ADHD-friendly.",
                imageUrl: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=300&fit=crop",
                buyPrice: 0.60,
                sellPrice: 7.99,
                scores: {
                    growth: 6.0,
                    youngAffluent: 6.0,
                    repeatPurchase: 7.5,
                    markup: 9.8,
                    competition: 4.0
                },
                buyLinks: [
                    { url: "https://www.1688.com/pop-it-toy", vendor: "Yiwu Toy Factory", price: "$0.60" },
                    { url: "https://www.alibaba.com/fidget-toy", vendor: "Shenzhen Silicone Products", price: "$0.65" },
                    { url: "https://www.made-in-china.com/sensory-toy", vendor: "Guangzhou Kids Toys", price: "$0.58" },
                    { url: "https://www.globalsources.com/bubble-toy", vendor: "Ningbo Toy Supply", price: "$0.62" }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/pop-it-toy", price: "$7.99" },
                    { platform: "TikTok Shop", url: "https://tiktok.com/shop/fidget-toy", price: "$6.50" },
                    { platform: "Walmart", url: "https://walmart.com/pop-it", price: "$8.88" },
                    { platform: "Target", url: "https://target.com/sensory-toy", price: "$9.99" }
                ]
            }
        ];
        
        // Default criteria
        const defaultCriteria = [
            { id: 'growth', name: '3-Year Growth (CAGR)', weight: 20 },
            { id: 'youngAffluent', name: 'Young & Affluent Appeal', weight: 20 },
            { id: 'repeatPurchase', name: 'Repeat Purchase Likelihood', weight: 20 },
            { id: 'markup', name: 'Markup Potential', weight: 20 },
            { id: 'competition', name: 'Low Competition Score', weight: 20 }
        ];
        
        let criteria = [...defaultCriteria];
        let customCriteriaCount = 0;
        let bookmarkedProducts = JSON.parse(localStorage.getItem('bookmarkedProducts') || '[]');
        let activeCategory = 'all';
        let activeSortMode = 'score';
        let populatedCategories = new Set();
        let customCategories = [];
        
        // Initialize
        function init() {
            renderWeightControls();
            renderProducts();
            updateBookmarkCount();
        }
        
        function renderWeightControls() {
            const container = document.getElementById('weightControls');
            container.innerHTML = '';
            
            criteria.forEach(criterion => {
                const div = document.createElement('div');
                div.className = 'weight-item';
                div.innerHTML = `
                    <label>${criterion.name}</label>
                    <div class="weight-input">
                        <input type="range" min="0" max="100" value="${criterion.weight}" 
                               onchange="updateWeight('${criterion.id}', this.value)">
                        <div class="weight-value">${criterion.weight}%</div>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function updateWeight(criterionId, value) {
            const criterion = criteria.find(c => c.id === criterionId);
            if (criterion) {
                criterion.weight = parseInt(value);
                renderWeightControls();
                renderProducts();
            }
        }
        
        function calculateTotalScore(product) {
            let totalScore = 0;
            let totalWeight = 0;
            
            criteria.forEach(criterion => {
                const score = product.scores[criterion.id] || 5;
                totalScore += score * criterion.weight;
                totalWeight += criterion.weight;
            });
            
            return totalWeight > 0 ? (totalScore / totalWeight).toFixed(1) : 0;
        }
        
        function filterCategory(category) {
            activeCategory = category;
            
            // Update button states
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide populate bar
            const populateBar = document.getElementById('populateBar');
            const sortingControls = document.getElementById('sortingControls');
            const populateBtn = document.getElementById('populateBtn');
            
            if (category === 'all') {
                populateBar.style.display = 'none';
                sortingControls.style.display = 'block'; // Show sorting for "All Products"
            } else {
                populateBar.style.display = 'block';
                
                // Update button text and style based on if category is populated
                if (populatedCategories.has(category)) {
                    populateBtn.textContent = 'Populate New Results';
                    populateBtn.classList.add('populated');
                    sortingControls.style.display = 'block';
                } else {
                    populateBtn.textContent = 'Search for Products in This Category';
                    populateBtn.classList.remove('populated');
                    
                    // Check if there are any products in this category
                    const hasProducts = productDatabase.some(p => p.category === category);
                    sortingControls.style.display = hasProducts ? 'block' : 'none';
                }
            }
            
            renderProducts();
        }
        
        function addCustomCategory() {
            const input = document.getElementById('customCategoryInput');
            const categoryName = input.value.trim();
            
            if (!categoryName) {
                alert('Please enter a category name');
                return;
            }
            
            // Add to custom categories
            if (!customCategories.includes(categoryName)) {
                customCategories.push(categoryName);
            }
            
            // Switch to this category
            activeCategory = categoryName;
            
            // Update all category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show populate bar
            const populateBar = document.getElementById('populateBar');
            const populateBtn = document.getElementById('populateBtn');
            populateBar.style.display = 'block';
            populateBtn.textContent = 'Search for Products in This Category';
            populateBtn.classList.remove('populated');
            
            document.getElementById('sortingControls').style.display = 'none';
            
            input.value = '';
            
            // Clear products for custom category initially
            renderProducts();
        }
        
        async function populateProducts() {
            const populateBtn = document.getElementById('populateBtn');
            const sortingControls = document.getElementById('sortingControls');
            
            // Show loading state
            const originalText = populateBtn.textContent;
            populateBtn.textContent = 'Searching...';
            populateBtn.disabled = true;
            
            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Generate new products for this category
            const newProducts = await generateProductsForCategory(activeCategory);
            
            // Add to database if not duplicates
            newProducts.forEach(product => {
                const exists = productDatabase.find(p => p.name === product.name);
                if (!exists) {
                    productDatabase.push(product);
                }
            });
            
            // Mark category as populated
            populatedCategories.add(activeCategory);
            
            // Update button
            populateBtn.textContent = 'Populate New Results';
            populateBtn.classList.add('populated');
            populateBtn.disabled = false;
            
            // Show sorting controls
            sortingControls.style.display = 'block';
            
            // Render products
            renderProducts();
        }
        
        async function generateProductsForCategory(category) {
            // Product generation templates - now with 10+ items per category
            const templates = {
                'Beauty & Skincare': [
                    { name: 'Retinol Night Cream', desc: 'Anti-aging night cream with 2.5% retinol and peptides. Reduces fine lines and wrinkles.', img: 'https://images.unsplash.com/photo-1556228578-0d85b1a4d571?w=400&h=300&fit=crop', buy: 3.80, sell: 24.99 },
                    { name: 'Hyaluronic Acid Essence', desc: '100% pure hyaluronic acid serum. Intense hydration and plumping effect.', img: 'https://images.unsplash.com/photo-1571875257727-256c39da42af?w=400&h=300&fit=crop', buy: 2.20, sell: 16.99 },
                    { name: 'LED Face Mask', desc: '7-color LED therapy mask for anti-aging and acne treatment. Professional spa at home.', img: 'https://images.unsplash.com/photo-1512496015851-a90fb38ba796?w=400&h=300&fit=crop', buy: 12.50, sell: 79.99 },
                    { name: 'Jade Facial Roller', desc: 'Natural jade stone roller for lymphatic drainage. Includes rose quartz gua sha.', img: 'https://images.unsplash.com/photo-1598440947619-2c35fc9aa908?w=400&h=300&fit=crop', buy: 2.90, sell: 18.99 },
                    { name: 'Pore Vacuum Cleaner', desc: 'USB rechargeable blackhead remover with 4 suction levels. Visible results instantly.', img: 'https://images.unsplash.com/photo-1556228453-efd6c1ff04f6?w=400&h=300&fit=crop', buy: 6.80, sell: 34.99 },
                    { name: 'Sheet Mask Set 20-Pack', desc: 'Korean beauty sheet masks with different treatments. Hydrating, brightening, anti-aging.', img: 'https://images.unsplash.com/photo-1608248543803-ba4f8c70ae0b?w=400&h=300&fit=crop', buy: 4.50, sell: 22.99 },
                    { name: 'Eyelash Curler Heated', desc: 'Electric heated eyelash curler with quick heat-up. Long-lasting curl in 30 seconds.', img: 'https://images.unsplash.com/photo-1583001308922-ddd34397bb8e?w=400&h=300&fit=crop', buy: 3.20, sell: 16.99 },
                    { name: 'Makeup Brush Cleaner', desc: 'Automatic brush cleaner and dryer. Cleans 10 brushes in under 1 minute.', img: 'https://images.unsplash.com/photo-1596704017254-9b121068fb31?w=400&h=300&fit=crop', buy: 7.90, sell: 39.99 },
                    { name: 'Silicone Face Scrubber', desc: 'Sonic vibration facial cleanser. Removes 99% of dirt and makeup residue.', img: 'https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?w=400&h=300&fit=crop', buy: 5.40, sell: 27.99 },
                    { name: 'Microneedling Derma Roller', desc: '0.25mm titanium needles for collagen production. Reduces scars and wrinkles.', img: 'https://images.unsplash.com/photo-1612817288484-6f916006741a?w=400&h=300&fit=crop', buy: 4.10, sell: 21.99 },
                    { name: 'Lip Plumper Gloss', desc: 'Instant lip volumizer with hyaluronic acid. Natural bee venom formula.', img: 'https://images.unsplash.com/photo-1586495777744-4413f21062fa?w=400&h=300&fit=crop', buy: 1.80, sell: 12.99 },
                    { name: 'Beauty Blender Sponge Set', desc: '5-pack makeup sponges in different shapes. Latex-free, expands when wet.', img: 'https://images.unsplash.com/photo-1591814468924-caf88d1232e1?w=400&h=300&fit=crop', buy: 2.50, sell: 14.99 }
                ],
                'Tech & Gadgets': [
                    { name: 'Wireless Charging Pad', desc: '15W fast wireless charger with LED indicator. Compatible with all Qi devices.', img: 'https://images.unsplash.com/photo-1591290619762-d4e3f5d0e326?w=400&h=300&fit=crop', buy: 3.20, sell: 19.99 },
                    { name: 'Mini Bluetooth Speaker', desc: 'Portable waterproof speaker with 360Â° sound. 12-hour battery life.', img: 'https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=400&h=300&fit=crop', buy: 5.80, sell: 29.99 },
                    { name: 'Smart Watch Band', desc: 'Silicone sport band with quick-release mechanism. Fits Apple Watch & compatible watches.', img: 'https://images.unsplash.com/photo-1434494878577-86c23bcb06b9?w=400&h=300&fit=crop', buy: 1.20, sell: 12.99 },
                    { name: 'Phone Ring Light', desc: 'Clip-on LED ring light with 3 brightness levels. Perfect for selfies and video calls.', img: 'https://images.unsplash.com/photo-1550009158-9ebf69173e03?w=400&h=300&fit=crop', buy: 2.80, sell: 15.99 },
                    { name: 'Cable Organizer Box', desc: 'Cord management box with multiple outlets. Hides messy cables beautifully.', img: 'https://images.unsplash.com/photo-1625948515291-69613efd103f?w=400&h=300&fit=crop', buy: 4.50, sell: 22.99 },
                    { name: 'Pop Socket Phone Grip', desc: 'Expandable phone holder with swappable tops. Works as kickstand.', img: 'https://images.unsplash.com/photo-1585060544812-6b45742d762f?w=400&h=300&fit=crop', buy: 0.80, sell: 8.99 },
                    { name: 'USB Hub 7-Port', desc: 'Powered USB 3.0 hub with individual switches. High-speed data transfer.', img: 'https://images.unsplash.com/photo-1625948515291-69613efd103f?w=400&h=300&fit=crop', buy: 5.20, sell: 24.99 },
                    { name: 'Webcam Cover Slider', desc: '3-pack privacy covers for laptop cameras. Ultra-thin, adhesive design.', img: 'https://images.unsplash.com/photo-1593642532400-2682810df593?w=400&h=300&fit=crop', buy: 0.50, sell: 6.99 },
                    { name: 'Screen Cleaning Kit', desc: 'Microfiber cloth with cleaning solution. Safe for all screens and lenses.', img: 'https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?w=400&h=300&fit=crop', buy: 1.60, sell: 11.99 },
                    { name: 'Bluetooth Tracker Tile', desc: 'Key finder with GPS tracking. Loud ring and app integration.', img: 'https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=400&h=300&fit=crop', buy: 3.90, sell: 19.99 },
                    { name: 'LED Strip Lights 16ft', desc: 'RGB color-changing strips with remote. App and voice control compatible.', img: 'https://images.unsplash.com/photo-1563089145-599997674d42?w=400&h=300&fit=crop', buy: 6.70, sell: 32.99 },
                    { name: 'Portable Power Bank', desc: '10,000mAh slim battery with dual USB ports. Fast charging technology.', img: 'https://images.unsplash.com/photo-1609592806717-69e0b1e99c23?w=400&h=300&fit=crop', buy: 7.50, sell: 34.99 }
                ],
                'Home & Kitchen': [
                    { name: 'Collapsible Silicone Strainer', desc: 'Space-saving colander that folds flat. Dishwasher safe, BPA-free.', img: 'https://images.unsplash.com/photo-1556911220-bff31c812dba?w=400&h=300&fit=crop', buy: 2.10, sell: 14.99 },
                    { name: 'Herb Scissors', desc: '5-blade herb scissors with cleaning comb. Perfect for fresh herbs and salads.', img: 'https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=400&h=300&fit=crop', buy: 1.80, sell: 11.99 },
                    { name: 'Magnetic Spice Jars', desc: 'Set of 12 magnetic containers that stick to fridge. Clear lids for easy identification.', img: 'https://images.unsplash.com/photo-1556911220-e15b29be8c8f?w=400&h=300&fit=crop', buy: 6.50, sell: 32.99 },
                    { name: 'Bag Sealer Clip', desc: '6-pack heavy-duty chip clips with pour spout. Keeps food fresh longer.', img: 'https://images.unsplash.com/photo-1585659722983-3a675dabf23d?w=400&h=300&fit=crop', buy: 1.20, sell: 9.99 },
                    { name: 'Over-the-Sink Cutting Board', desc: 'Bamboo board with built-in colander. Extends counter space.', img: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop', buy: 8.90, sell: 44.99 },
                    { name: 'Silicone Baking Mat Set', desc: 'Non-stick reusable mats, replaces parchment paper. Heat resistant to 480Â°F.', img: 'https://images.unsplash.com/photo-1556911220-bff31c812dba?w=400&h=300&fit=crop', buy: 3.40, sell: 18.99 },
                    { name: 'Veggie Chopper Dicer', desc: 'One-push food chopper with 4 interchangeable blades. Dices onions without tears.', img: 'https://images.unsplash.com/photo-1556909212-d5b604d0c90d?w=400&h=300&fit=crop', buy: 5.60, sell: 27.99 },
                    { name: 'Measuring Cup Spoons', desc: 'Stackable measuring cups and spoons set. Space-saving magnetic storage.', img: 'https://images.unsplash.com/photo-1556911220-bff31c812dba?w=400&h=300&fit=crop', buy: 2.80, sell: 15.99 },
                    { name: 'Sink Caddy Organizer', desc: 'Sponge holder with drain tray. Suction cups for secure attachment.', img: 'https://images.unsplash.com/photo-1556911220-bff31c812dba?w=400&h=300&fit=crop', buy: 3.20, sell: 16.99 },
                    { name: 'Tea Infuser Bottle', desc: 'Glass bottle with removable strainer. Hot and cold brew compatible.', img: 'https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400&h=300&fit=crop', buy: 4.50, sell: 22.99 },
                    { name: 'Expandable Drawer Dividers', desc: '4-pack adjustable organizers for kitchen drawers. Bamboo construction.', img: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop', buy: 5.80, sell: 28.99 },
                    { name: 'Oil Spray Bottle', desc: 'Glass mister for olive oil and vinegar. Reduces oil use by 80%.', img: 'https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400&h=300&fit=crop', buy: 2.40, sell: 13.99 }
                ],
                'Fitness & Wellness': [
                    { name: 'Yoga Mat Non-Slip', desc: 'Extra thick 6mm TPE mat with carrying strap. Eco-friendly and odorless.', img: 'https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=400&h=300&fit=crop', buy: 6.50, sell: 32.99 },
                    { name: 'Foam Roller Massage', desc: 'Textured muscle roller for deep tissue therapy. Includes exercise guide.', img: 'https://images.unsplash.com/photo-1599901860904-17e6ed7083a0?w=400&h=300&fit=crop', buy: 4.80, sell: 24.99 },
                    { name: 'Adjustable Dumbbells', desc: 'Quick-change weights from 5-25 lbs. Space-saving all-in-one design.', img: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&h=300&fit=crop', buy: 15.00, sell: 74.99 },
                    { name: 'Jump Rope Speed', desc: 'Weighted rope with ball bearings. Adjustable length, anti-slip handles.', img: 'https://images.unsplash.com/photo-1598289431512-b97b0917affc?w=400&h=300&fit=crop', buy: 2.20, sell: 14.99 },
                    { name: 'Ab Roller Wheel', desc: 'Double wheel design with knee pad. Sturdy non-slip handles.', img: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&h=300&fit=crop', buy: 3.90, sell: 19.99 },
                    { name: 'Workout Gloves', desc: 'Breathable gym gloves with wrist support. Anti-slip silicone grip.', img: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&h=300&fit=crop', buy: 2.80, sell: 16.99 },
                    { name: 'Protein Shaker Bottle', desc: '28oz bottle with wire ball mixer. Leak-proof flip lid, BPA-free.', img: 'https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=400&h=300&fit=crop', buy: 2.40, sell: 13.99 },
                    { name: 'Balance Board Trainer', desc: 'Wooden wobble board for core strength. Anti-slip surface, 350lb capacity.', img: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&h=300&fit=crop', buy: 7.60, sell: 36.99 },
                    { name: 'Massage Ball Set', desc: 'Lacrosse and spiky balls for trigger points. Targets muscle knots.', img: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=400&h=300&fit=crop', buy: 3.20, sell: 17.99 },
                    { name: 'Resistance Bands Long', desc: '41-inch pull-up assist bands in 5 resistance levels. Natural latex.', img: 'https://images.unsplash.com/photo-1598289431512-b97b0917affc?w=400&h=300&fit=crop', buy: 4.50, sell: 23.99 },
                    { name: 'Sweat Belt Waist Trimmer', desc: 'Neoprene sauna belt for weight loss. Adjustable velcro closure.', img: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop', buy: 3.40, sell: 18.99 },
                    { name: 'Yoga Blocks 2-Pack', desc: 'High-density foam blocks for support. Lightweight and durable.', img: 'https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=400&h=300&fit=crop', buy: 2.90, sell: 15.99 }
                ]
            };
            
            // Get templates for category or generate 12 generic ones
            let productTemplates = templates[category];
            
            if (!productTemplates) {
                productTemplates = Array.from({length: 12}, (_, i) => ({
                    name: `${category} Product ${String.fromCharCode(65 + i)}`,
                    desc: `Premium ${category} item. High-quality and trending in the market.`,
                    img: `https://images.unsplash.com/photo-${1523275335684 + i * 100000}-37898b6baf30?w=400&h=300&fit=crop`,
                    buy: parseFloat((Math.random() * 8 + 2).toFixed(2)),
                    sell: parseFloat((Math.random() * 40 + 15).toFixed(2))
                }));
            }
            
            // If category already populated, generate different products
            if (populatedCategories.has(category)) {
                const suffixes = ['Pro', 'Plus', 'Elite', 'Premium', 'Deluxe', 'Ultra', 'Max', 'Advanced', 'Smart', 'Premium', 'Professional', 'Ultimate'];
                productTemplates = Array.from({length: 12}, (_, i) => ({
                    name: `${suffixes[i]} ${category} ${String.fromCharCode(65 + i)}`,
                    desc: `Next-generation ${category} product. Innovative design and superior quality.`,
                    img: `https://images.unsplash.com/photo-${1560343090 + i * 100000}-f0409e92791a?w=400&h=300&fit=crop`,
                    buy: parseFloat((Math.random() * 10 + 3).toFixed(2)),
                    sell: parseFloat((Math.random() * 50 + 20).toFixed(2))
                }));
            }
            
            // Generate products with random scores
            return productTemplates.map(template => ({
                category: category,
                name: template.name,
                description: template.desc,
                imageUrl: template.img,
                buyPrice: template.buy,
                sellPrice: template.sell,
                scores: {
                    growth: parseFloat((Math.random() * 3 + 6).toFixed(1)),
                    youngAffluent: parseFloat((Math.random() * 3 + 6).toFixed(1)),
                    repeatPurchase: parseFloat((Math.random() * 4 + 4).toFixed(1)),
                    markup: parseFloat((Math.random() * 2 + 7).toFixed(1)),
                    competition: parseFloat((Math.random() * 3 + 5).toFixed(1))
                },
                buyLinks: [
                    { url: "https://www.1688.com/search?q=" + encodeURIComponent(template.name), vendor: "Guangzhou Supplier", price: `$${template.buy.toFixed(2)}` },
                    { url: "https://www.alibaba.com/trade/search?q=" + encodeURIComponent(template.name), vendor: "Shenzhen Factory", price: `$${(template.buy * 1.1).toFixed(2)}` },
                    { url: "https://www.made-in-china.com/products-search/hot-china-products/" + encodeURIComponent(template.name), vendor: "Zhejiang Manufacturer", price: `$${(template.buy * 0.95).toFixed(2)}` },
                    { url: "https://www.globalsources.com/manufacturers/" + encodeURIComponent(template.name), vendor: "Ningbo Trading Co.", price: `$${(template.buy * 1.05).toFixed(2)}` }
                ],
                sellLinks: [
                    { platform: "Amazon", url: "https://amazon.com/s?k=" + encodeURIComponent(template.name), price: `$${template.sell.toFixed(2)}` },
                    { platform: "TikTok Shop", url: "https://tiktok.com/search?q=" + encodeURIComponent(template.name), price: `$${(template.sell * 0.9).toFixed(2)}` },
                    { platform: "eBay", url: "https://ebay.com/sch/" + encodeURIComponent(template.name), price: `$${(template.sell * 1.05).toFixed(2)}` },
                    { platform: "Walmart", url: "https://walmart.com/search?q=" + encodeURIComponent(template.name), price: `$${(template.sell * 1.1).toFixed(2)}` }
                ]
            }));
        }
        
        function sortProducts(mode) {
            activeSortMode = mode;
            
            // Update button states
            document.querySelectorAll('.sort-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderProducts();
        }
        
        function renderProducts() {
            const container = document.getElementById('productsContainer');
            const sortingControls = document.getElementById('sortingControls');
            
            // Filter products by category
            let filteredProducts = activeCategory === 'all' 
                ? productDatabase 
                : productDatabase.filter(p => p.category === activeCategory);
            
            // Show/hide sorting based on whether there are products
            if (filteredProducts.length > 0) {
                sortingControls.style.display = 'block';
            }
            
            // Sort based on active mode
            let sortedProducts;
            if (activeSortMode === 'score') {
                sortedProducts = [...filteredProducts].sort((a, b) => 
                    calculateTotalScore(b) - calculateTotalScore(a)
                );
            } else if (activeSortMode === 'price') {
                sortedProducts = [...filteredProducts].sort((a, b) => 
                    b.sellPrice - a.sellPrice
                );
            } else if (activeSortMode === 'margin') {
                sortedProducts = [...filteredProducts].sort((a, b) => {
                    const marginA = ((a.sellPrice - a.buyPrice) / a.sellPrice) * 100;
                    const marginB = ((b.sellPrice - b.buyPrice) / b.sellPrice) * 100;
                    return marginB - marginA;
                });
            }
            
            if (sortedProducts.length === 0) {
                sortingControls.style.display = 'none';
                container.innerHTML = '<div style="text-align: center; padding: 60px 20px; color: white; font-size: 18px;">No products yet. Click "Search for Products" to populate this category.</div>';
                return;
            }
            
            container.innerHTML = sortedProducts.map(product => {
                const totalScore = calculateTotalScore(product);
                const isBookmarked = bookmarkedProducts.some(p => p.name === product.name);
                
                return `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${product.imageUrl}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/400x300?text=${encodeURIComponent(product.name)}'">
                        </div>
                        <div class="product-content">
                            <div class="product-header">
                                <div class="product-category">${product.category}</div>
                                <button class="bookmark-btn" onclick="toggleBookmark('${product.name}')">
                                    ${isBookmarked ? 'â­' : 'â˜†'}
                                </button>
                            </div>
                            <div class="product-name">${product.name}</div>
                            <div class="product-description">${product.description}</div>
                            
                            <div class="price-row">
                                <div class="price-item">
                                    <div class="price-label">Buy Price</div>
                                    <div class="price-value buy">$${product.buyPrice.toFixed(2)}</div>
                                </div>
                                <div class="price-item">
                                    <div class="price-label">Sell Price</div>
                                    <div class="price-value sell">$${product.sellPrice.toFixed(2)}</div>
                                </div>
                                <div class="price-item">
                                    <div class="price-label">Margin</div>
                                    <div class="price-value">${(((product.sellPrice - product.buyPrice) / product.sellPrice) * 100).toFixed(0)}%</div>
                                </div>
                            </div>
                            
                            <div class="total-score">
                                <div class="total-score-label">Overall Score</div>
                                <div class="total-score-value">${totalScore}/10</div>
                            </div>
                            
                            <div class="scores">
                                ${criteria.map(criterion => {
                                    const score = parseFloat(product.scores[criterion.id]) || 5.0;
                                    return `
                                        <div class="score-item">
                                            <div class="score-label">${criterion.name}</div>
                                            <div class="score-bar">
                                                <div class="score-fill">
                                                    <div class="score-fill-inner" style="width: ${score * 10}%"></div>
                                                </div>
                                                <div class="score-number">${score.toFixed(1)}</div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                            
                            <button class="view-links-btn" onclick="showLinks('${product.name}')">
                                View Sourcing & Selling Links
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleBookmark(productName) {
            const product = productDatabase.find(p => p.name === productName);
            const index = bookmarkedProducts.findIndex(p => p.name === productName);
            
            if (index > -1) {
                bookmarkedProducts.splice(index, 1);
            } else {
                bookmarkedProducts.push(product);
            }
            
            localStorage.setItem('bookmarkedProducts', JSON.stringify(bookmarkedProducts));
            renderProducts();
            renderBookmarks();
            updateBookmarkCount();
        }
        
        function renderBookmarks() {
            const container = document.getElementById('bookmarksContainer');
            
            if (bookmarkedProducts.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 60px 20px; color: white; font-size: 18px;">No bookmarked products yet. Start researching!</div>';
                return;
            }
            
            container.innerHTML = bookmarkedProducts.map(product => {
                const totalScore = calculateTotalScore(product);
                
                return `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${product.imageUrl}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/400x300?text=${encodeURIComponent(product.name)}'">
                        </div>
                        <div class="product-content">
                            <div class="product-header">
                                <div class="product-category">${product.category}</div>
                                <button class="bookmark-btn" onclick="toggleBookmark('${product.name}')">â­</button>
                            </div>
                            <div class="product-name">${product.name}</div>
                            <div class="product-description">${product.description}</div>
                            
                            <div class="price-row">
                                <div class="price-item">
                                    <div class="price-label">Buy Price</div>
                                    <div class="price-value buy">$${product.buyPrice.toFixed(2)}</div>
                                </div>
                                <div class="price-item">
                                    <div class="price-label">Sell Price</div>
                                    <div class="price-value sell">$${product.sellPrice.toFixed(2)}</div>
                                </div>
                                <div class="price-item">
                                    <div class="price-label">Margin</div>
                                    <div class="price-value">${(((product.sellPrice - product.buyPrice) / product.sellPrice) * 100).toFixed(0)}%</div>
                                </div>
                            </div>
                            
                            <div class="total-score">
                                <div class="total-score-label">Overall Score</div>
                                <div class="total-score-value">${totalScore}/10</div>
                            </div>
                            
                            <button class="view-links-btn" onclick="showLinks('${product.name}')">
                                View Sourcing & Selling Links
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateBookmarkCount() {
            document.getElementById('bookmarkCount').textContent = bookmarkedProducts.length;
        }
        
        function showLinks(productName) {
            const product = productDatabase.find(p => p.name === productName);
            if (!product) return;
            
            document.getElementById('modalProductName').textContent = product.name;
            
            const buyLinksHtml = product.buyLinks.map(link => `
                <div class="link-item">
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 4px;">${link.vendor}</div>
                        <a href="${link.url}" target="_blank">${link.url}</a>
                    </div>
                    <div class="link-price">${link.price}</div>
                </div>
            `).join('');
            
            const sellLinksHtml = product.sellLinks.map(link => `
                <div class="link-item">
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 4px;">${link.platform}</div>
                        <a href="${link.url}" target="_blank">${link.url}</a>
                    </div>
                    <div class="link-price">${link.price}</div>
                </div>
            `).join('');
            
            document.getElementById('buyLinks').innerHTML = buyLinksHtml;
            document.getElementById('sellLinks').innerHTML = sellLinksHtml;
            document.getElementById('linksModal').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('linksModal').classList.remove('active');
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'research') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('researchTab').classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('bookmarksTab').classList.add('active');
                renderBookmarks();
            }
        }
        
        function addCustomCriteria() {
            customCriteriaCount++;
            const container = document.getElementById('customCriteriaContainer');
            const div = document.createElement('div');
            div.className = 'custom-criteria';
            div.innerHTML = `
                <input type="text" placeholder="New criteria name (e.g., 'Viral TikTok Potential')" id="customName${customCriteriaCount}">
                <button class="add-criteria-btn" onclick="saveCustomCriteria(${customCriteriaCount})">Save Criteria</button>
            `;
            container.appendChild(div);
        }
        
        function saveCustomCriteria(id) {
            const nameInput = document.getElementById(`customName${id}`);
            const name = nameInput.value.trim();
            
            if (name) {
                const criterionId = 'custom' + id;
                criteria.push({ id: criterionId, name: name, weight: 20 });
                
                // Add default score to all products
                productDatabase.forEach(product => {
                    product.scores[criterionId] = 5.0;
                });
                
                renderWeightControls();
                renderProducts();
                document.getElementById('customCriteriaContainer').innerHTML = '';
                
                alert(`New criteria "${name}" added! Default score of 5.0 assigned to all products. You can manually adjust scores in the product database.`);
            }
        }
        
        // Initialize on load
        setTimeout(init, 1000);
    </script>
</body>
</html>